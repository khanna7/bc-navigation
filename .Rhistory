diff
rm(list=ls())
library(ggplot2)
library(plotly)
library(dplyr)
library(cowplot)
#Specify absolute path for counts or knit will have an error
#counts <- read.csv("/project2/khanna7/bryanb/NEST/nest/p2m/swift_proj/experiments/March_26_HIVtest_scenario_0.5_9month/instance_1/output/counts.csv")
counts_h <- read.csv("/project2/khanna7/dsheeler/p2m/swift_proj/experiments/francis_upf/instance_6/output/counts.csv")
counts_t  <-read.csv("/project2/khanna7/dsheeler/p2m/swift_proj/experiments/francis_upf/instance_4/output/counts.csv")
rm(list=ls())
library(ggplot2)
library(plotly)
library(dplyr)
library(cowplot)
counts_h <- read.csv("/project2/ahotton/bryanb/NEST/nest_6_9_2021/p2m/swift_proj/experiments/oct_6_60_yr_30_run_condom_mult/instance_6/output/counts.csv")
counts_t  <-read.csv("/project2/ahotton/bryanb/NEST/nest_6_9_2021/p2m/swift_proj/experiments/oct_6_60_yr_30_run_condom_mult/instance_7/output/counts.csv")
counts_no_t<-read.csv("/project2/ahotton/bryanb/NEST/nest_6_9_2021/p2m/swift_proj/experiments/oct_6_60_yr_30_run_condom_mult/instance_8/output/counts.csv")
counts_ho   <- read.csv("/project2/ahotton/bryanb/NEST/nest_6_9_2021/p2m/swift_proj/experiments/subpop_with_francis_UPF/instance_1/output/counts.csv")
counts_to   <-read.csv("/project2/ahotton/bryanb/NEST/nest_6_9_2021/p2m/swift_proj/experiments/subpop_with_francis_UPF/instance_2/output/counts.csv")
counts_no_to<-read.csv("/project2/ahotton/bryanb/NEST/nest_6_9_2021/p2m/swift_proj/experiments/subpop_with_francis_UPF/instance_3/output/counts.csv")
#Not sure why this is here
sort(colnames(counts_h))
sort(colnames(counts_t))
sort(colnames(counts_no_t))
#color code for scenarios
t   <-"run 1"
no_t<-"run 2"
h   <-"run 3"
# Population size
ggplot()+
xlab("Time (years)")+theme_bw()+labs(color = "Scenario")+
ylab("Total Population")+
geom_line(data = counts_h,
aes(x=tick/365, y=vertex_count, color=h)
)+
geom_line(data = counts_t,
aes(x=tick/365, y=vertex_count, color=t)
)+
geom_line(data = counts_no_t,
aes(x=tick/365, y=vertex_count, color=no_t)
)
#HIV Prevalence
ggplot()+
xlab("Time (years)")+theme_bw()+labs(color = "Scenario")+
ylab("HIV Prevalence (%)")+
geom_line(data = counts_h,
aes(x=tick/365,y=(vertex_count-uninfected)/vertex_count*100,color=h)
)+
geom_line(data = counts_t,
aes(x=tick/365,y=(vertex_count-uninfected)/vertex_count*100,color=t)
)+
geom_line(data = counts_no_t,
aes(x=tick/365,y=(vertex_count-uninfected)/vertex_count*100,color=no_t)
)
# Syphilis Prevalence
ggplot()+
xlab("Time (years)")+theme_bw()+labs(color = "Scenario")+
ylab("Syphilis Prevalence (%)")+
geom_line(data = counts_h,
aes(x=tick/365, y=syphilis_infected/vertex_count*100, color=h)
)+
geom_line(data = counts_t,
aes(x=tick/365, y=syphilis_infected/vertex_count*100, color=t)
)+
geom_line(data = counts_no_t,
aes(x=tick/365, y=syphilis_infected/vertex_count*100,color=no_t)
)
##Overall HIV Incidence
years<-10 ## Change this to fit data
max <-365
#
hiv_infections <- counts_h$infected_via_transmission
daily_infections<-hiv_infections[2:(365*years)] #excludes step 1 due to initial infections
hiv_uninfected <- counts_h$uninfected
hiv_uninfected_yesterday<-hiv_uninfected[1:(365*years)-1]
hiv_uninfected_yesterday[1]<-5000
daily_incidence<-daily_infections/hiv_uninfected_yesterday
i <- seq_along(daily_incidence)
chunks_incidence <- split(daily_incidence, ceiling(i/max))
yearly_sum_of_daily_incidences <- lapply(chunks_incidence, sum) #Note here that we don't have to divide by 365 ((x*365)/365)
yearly_avg_incidence_ppy <- Map("*",yearly_sum_of_daily_incidences,c(100))#per 100 py, not pct!
yaip_h <- unlist(yearly_avg_incidence_ppy)
#
hiv_infections <- counts_no_t$infected_via_transmission
daily_infections<-hiv_infections[2:(365*years)]
hiv_uninfected <- counts_no_t$uninfected
hiv_uninfected_yesterday<-hiv_uninfected[1:(365*years)-1]
hiv_uninfected_yesterday[1]<-5000
daily_incidence<-daily_infections/hiv_uninfected_yesterday
i <- seq_along(daily_incidence)
chunks_incidence <- split(daily_incidence, ceiling(i/max))
yearly_sum_of_daily_incidences <- lapply(chunks_incidence, sum) #Note here that we don't have to divide by 365 ((x*365)/365)
yearly_avg_incidence_ppy <- Map("*",yearly_sum_of_daily_incidences,c(100))
yaip_no_t <- unlist(yearly_avg_incidence_ppy)
#
hiv_infections <- counts_t$infected_via_transmission
daily_infections<-hiv_infections[2:(365*years)]
hiv_uninfected <- counts_t$uninfected
hiv_uninfected_yesterday<-hiv_uninfected[1:(365*years)-1]
hiv_uninfected_yesterday[1]<-5000
daily_incidence<-daily_infections/hiv_uninfected_yesterday
i <- seq_along(daily_incidence)
chunks_incidence <- split(daily_incidence, ceiling(i/max))
yearly_sum_of_daily_incidences <- lapply(chunks_incidence, sum) #Note here that we don't have to divide by 365 ((x*365)/365)
yearly_avg_incidence_ppy <- Map("*",yearly_sum_of_daily_incidences,c(100))
yaip_t <- unlist(yearly_avg_incidence_ppy)
#
plot(x=1:length(yaip_h), y=yaip_h, type="b", col='red', pch=15,cex=.8, lty=1,
ylab="Incidence (per 100 py)", xlab="Time (years)", main="HIV Incidence",
panel.first=grid(), ylim=c(0,23))
lines(1:length(yaip_t), yaip_t, pch = 17,cex=.8, col = "blue", type = "b", lty = 2)
lines(1:length(yaip_no_t), yaip_no_t, pch = 19,cex=.8, col = "black", type = "b", lty = 3)
#lines(1:length(yaip_no_t), rep(2,length(yaip_no_t)), pch = 19,cex=.5, col = "orange", type = "l", lty = 1)
legend("topright", legend=c("run 1", "run 2", "run 3"),
col=c("red", "blue", "black", "orange"), lty = c(1,2,3,1), cex=0.8)
#Overall Syphilis Incidence
##Numerator: Number infected by year
#
daily_infections<-counts_h$syphilis_infected_via_transmission[2:(365*years)]
daily_uninfected_yesterday<-counts_h$syphilis_uninfected[1:(365*years)-1]
daily_uninfected_yesterday[1]<-5000
daily_incidence<-daily_infections/daily_uninfected_yesterday
i <- seq_along(daily_incidence)
chunks_incidence <- split(daily_incidence, ceiling(i/max))
yearly_sum_of_daily_incidences <- lapply(chunks_incidence, sum) #Note here that we don't have to divide by 365 ((x*365)/365)
yearly_avg_incidence_pct <- Map("*",yearly_sum_of_daily_incidences,c(100))
yaip_h <- unlist(yearly_avg_incidence_pct)
#
daily_infections<-counts_no_t$syphilis_infected_via_transmission[2:(365*years)]
daily_uninfected_yesterday<-counts_no_t$syphilis_uninfected[1:(365*years)-1]
daily_uninfected_yesterday[1]<-5000
daily_incidence<-daily_infections/daily_uninfected_yesterday
i <- seq_along(daily_incidence)
chunks_incidence <- split(daily_incidence, ceiling(i/max))
yearly_sum_of_daily_incidences <- lapply(chunks_incidence, sum) #Note here that we don't have to divide by 365 ((x*365)/365)
yearly_avg_incidence_pct <- Map("*",yearly_sum_of_daily_incidences,c(100))
yaip_no_t <- unlist(yearly_avg_incidence_pct)
#
daily_infections<-counts_t$syphilis_infected_via_transmission[2:(365*years)]
daily_uninfected_yesterday<-counts_t$syphilis_uninfected[1:(365*years)-1]
daily_uninfected_yesterday[1]<-5000
daily_incidence<-daily_infections/daily_uninfected_yesterday
i <- seq_along(daily_incidence)
chunks_incidence <- split(daily_incidence, ceiling(i/max))
yearly_sum_of_daily_incidences <- lapply(chunks_incidence, sum) #Note here that we don't have to divide by 365 ((x*365)/365)
yearly_avg_incidence_pct <- Map("*",yearly_sum_of_daily_incidences,c(100))
yaip_t <- unlist(yearly_avg_incidence_pct)
#
##Option 1 (points and lines)
plot(x=1:length(yaip_h), y=yaip_h, type="b", col='red', pch=15, cex=.9,lty=1,
ylab="Incidence per 100 py)", xlab="Time (years)", main="Syphilis Incidence",
panel.first=grid(), ylim=c(0,40))
lines(1:length(yaip_t), yaip_t, pch = 17, cex=.9, col = "blue", type = "b", lty = 2)
lines(1:length(yaip_no_t), yaip_no_t, pch = 19,cex=.9, col = "black", type = "b", lty = 3)
#lines(1:length(yaip_no_t), rep(0.783,length(yaip_no_t)), pch = 19,cex=.5, col = "orange", type = "l", lty = 1)
legend("topright", legend=c("run 1", "run 2", "run 3"),
col=c("red", "blue", "black"), lty = c(1,2,3,1), cex=0.8)
##Option 2 (Only Lines)
plot(x=1:length(yaip_h), y=yaip_h, type="l", col='red', pch=15, lty=1,
ylab="Incidence (per 100 py)", xlab="Time (years)", main="Syphilis Incidence",
panel.first=grid(), ylim=c(0,40))
lines(1:length(yaip_t), yaip_t, pch = 17, col = "blue", type = "l", lty = 2)
lines(1:length(yaip_no_t), yaip_no_t, pch = 19, col = "black", type = "l", lty = 3)
legend("topright", legend=c("run 1", "run 2", "run 3"),
col=c("red", "blue", "black"), lty = 1:3, cex=0.8)
#Swiss Paper version of Incidence (distinguish between HIV diagnosed and undiagnosed)
##Incidence among agents WITHOUT HIV
#
non_hiv_syphilis_infections <- counts_h$syphilis_infected_via_transmission - counts_h$hiv_positives_infected_with_syphilis
daily_infections<-non_hiv_syphilis_infections[2:(365*years)]
non_hiv_syphilis_uninfected <- counts_h$syphilis_uninfected - counts_h$hiv_positives_who_currently_have_syphilis
non_hiv_syphilis_uninfected_yesterday<-non_hiv_syphilis_uninfected[1:(365*years)-1]
non_hiv_syphilis_uninfected_yesterday[1]<-5000
daily_incidence<-daily_infections/non_hiv_syphilis_uninfected_yesterday
i <- seq_along(daily_incidence)
chunks_incidence <- split(daily_incidence, ceiling(i/max))
yearly_sum_of_daily_incidences <- lapply(chunks_incidence, sum) #Note here that we don't have to divide by 365 ((x*365)/365)
yearly_avg_incidence_pct <- Map("*",yearly_sum_of_daily_incidences,c(100))
yaip_h <- unlist(yearly_avg_incidence_pct)
#
non_hiv_syphilis_infections <- counts_no_t$syphilis_infected_via_transmission - counts_no_t$hiv_positives_infected_with_syphilis
daily_infections<-non_hiv_syphilis_infections[2:(365*years)]
non_hiv_syphilis_uninfected <- counts_no_t$syphilis_uninfected - counts_no_t$hiv_positives_who_currently_have_syphilis
non_hiv_syphilis_uninfected_yesterday<-non_hiv_syphilis_uninfected[1:(365*years)-1]
non_hiv_syphilis_uninfected_yesterday[1]<-5000
daily_incidence<-daily_infections/non_hiv_syphilis_uninfected_yesterday
i <- seq_along(daily_incidence)
chunks_incidence <- split(daily_incidence, ceiling(i/max))
yearly_sum_of_daily_incidences <- lapply(chunks_incidence, sum) #Note here that we don't have to divide by 365 ((x*365)/365)
yearly_avg_incidence_pct <- Map("*",yearly_sum_of_daily_incidences,c(100))
yaip_no_t <- unlist(yearly_avg_incidence_pct)
#
non_hiv_syphilis_infections <- counts_t$syphilis_infected_via_transmission - counts_t$hiv_positives_infected_with_syphilis
daily_infections<-non_hiv_syphilis_infections[2:(365*years)]
non_hiv_syphilis_uninfected <- counts_t$syphilis_uninfected - counts_t$hiv_positives_who_currently_have_syphilis
non_hiv_syphilis_uninfected_yesterday<-non_hiv_syphilis_uninfected[1:(365*years)-1]
non_hiv_syphilis_uninfected_yesterday[1]<-5000
daily_incidence<-daily_infections/non_hiv_syphilis_uninfected_yesterday
i <- seq_along(daily_incidence)
chunks_incidence <- split(daily_incidence, ceiling(i/max))
yearly_sum_of_daily_incidences <- lapply(chunks_incidence, sum) #Note here that we don't have to divide by 365 ((x*365)/365)
yearly_avg_incidence_pct <- Map("*",yearly_sum_of_daily_incidences,c(100))
yaip_t <- unlist(yearly_avg_incidence_pct)
#
plot(x=1:length(yaip_h[-c(1, 2,3)]), y=yaip_h[-c(1, 2,3)], type="b", col='red', pch=15,cex=.8, lty=1,
ylab="Incidence (per 100 py)", xlab="Time (years)", main="Syphilis incidence among agents without HIV",
panel.first=grid(), ylim=c(0,15))
lines(1:length(yaip_t[-c(1, 2,3)]), yaip_t[-c(1, 2,3)], pch = 17,cex=.8, col = "blue", type = "b", lty = 2)
lines(1:length(yaip_no_t[-c(1, 2,3)]), yaip_no_t[-c(1, 2,3)], pch = 19,cex=.8, col = "black", type = "b", lty = 3)
#lines(1:length(yaip_no_t), rep(0.783,length(yaip_no_t)), pch = 19,cex=.5, col = "orange", type = "l", lty = 1)
legend("topright", legend=c("run 1", "run 2", "run 3"),
col=c("red", "blue", "black", "orange"), lty = c(1,2,3,1), cex=0.8)
#Swiss Paper version of Incidence (distinguish between HIV diagnosed and undiagnosed)
##Syphilis Incidence among agents WITH HIV
#
hiv_syphilis_infections <- counts_h$hiv_positives_infected_with_syphilis
daily_infections<-hiv_syphilis_infections[2:(365*years)]
hiv_syphilis_uninfected <- counts_h$vertex_count - counts_h$uninfected - counts_h$hiv_positives_who_currently_have_syphilis
hiv_syphilis_uninfected_yesterday<-hiv_syphilis_uninfected[1:(365*years)-1]
hiv_syphilis_uninfected_yesterday[1]<-5000
daily_incidence<-daily_infections/hiv_syphilis_uninfected_yesterday
i <- seq_along(daily_incidence)
chunks_incidence <- split(daily_incidence, ceiling(i/max))
yearly_sum_of_daily_incidences <- lapply(chunks_incidence, sum) #Note here that we don't have to divide by 365 ((x*365)/365)
yearly_avg_incidence_pct <- Map("*",yearly_sum_of_daily_incidences,c(100))
yaip_h <- unlist(yearly_avg_incidence_pct)
#
hiv_syphilis_infections <- counts_no_t$hiv_positives_infected_with_syphilis
daily_infections<-hiv_syphilis_infections[2:(365*years)]
hiv_syphilis_uninfected <- counts_no_t$vertex_count - counts_no_t$uninfected - counts_no_t$hiv_positives_who_currently_have_syphilis
hiv_syphilis_uninfected_yesterday<-hiv_syphilis_uninfected[1:(365*years)-1]
hiv_syphilis_uninfected_yesterday[1]<-5000
daily_incidence<-daily_infections/hiv_syphilis_uninfected_yesterday
i <- seq_along(daily_incidence)
chunks_incidence <- split(daily_incidence, ceiling(i/max))
yearly_sum_of_daily_incidences <- lapply(chunks_incidence, sum) #Note here that we don't have to divide by 365 ((x*365)/365)
yearly_avg_incidence_pct <- Map("*",yearly_sum_of_daily_incidences,c(100))
yaip_no_t <- unlist(yearly_avg_incidence_pct)
#
hiv_syphilis_infections <- counts_t$hiv_positives_infected_with_syphilis
daily_infections<-hiv_syphilis_infections[2:(365*years)]
hiv_syphilis_uninfected <- counts_t$vertex_count - counts_t$uninfected - counts_t$hiv_positives_who_currently_have_syphilis
hiv_syphilis_uninfected_yesterday<-hiv_syphilis_uninfected[1:(365*years)-1]
hiv_syphilis_uninfected_yesterday[1]<-5000
daily_incidence<-daily_infections/hiv_syphilis_uninfected_yesterday
i <- seq_along(daily_incidence)
chunks_incidence <- split(daily_incidence, ceiling(i/max))
yearly_sum_of_daily_incidences <- lapply(chunks_incidence, sum) #Note here that we don't have to divide by 365 ((x*365)/365)
yearly_avg_incidence_pct <- Map("*",yearly_sum_of_daily_incidences,c(100))
yaip_t <- unlist(yearly_avg_incidence_pct)
#
plot(x=1:length(yaip_h[-c(1, 2,3)]), y=yaip_h[-c(1, 2,3)], type="b", col='red', pch=15,cex=.8, lty=1,
ylab="Incidence (per 100 py)", xlab="Time (years)", main="Syphilis incidence among agents with HIV",
panel.first=grid(), ylim=c(0,35))
lines(1:length(yaip_t[-c(1, 2,3)]), yaip_t[-c(1, 2,3)], pch = 17,cex=.8, col = "blue", type = "b", lty = 2)
lines(1:length(yaip_no_t[-c(1, 2,3)]), yaip_no_t[-c(1, 2,3)], pch = 19,cex=.8, col = "black", type = "b", lty = 3)
#lines(1:length(yaip_no_t), rep(0.783,length(yaip_no_t)), pch = 19,cex=.5, col = "orange", type = "l", lty = 1)
legend("topright", legend=c("run 1", "run 2", "run 3"),
col=c("red", "blue", "black", "orange"), lty = c(1,2,3,1), cex=0.8)
#Swiss Paper version of Incidence (distinguish between HIV diagnosed and undiagnosed)
#Syphilis Incidence in agents with HIV diagnosis
#
hiv_diagnosed_syphilis_infections <- counts_h$hiv_diagnosed_infected_with_syphilis
daily_infections<-hiv_diagnosed_syphilis_infections[2:(365*years)]
hiv_diagnosed_syphilis_uninfected <- counts_h$hiv_diagnosed_pop - counts_h$hiv_diagnosed_infected_with_syphilis
hiv_diagnosed_syphilis_uninfected_yesterday<-hiv_diagnosed_syphilis_uninfected[1:(365*years)-1]
hiv_diagnosed_syphilis_uninfected_yesterday[1]<-5000
daily_incidence<-daily_infections/hiv_diagnosed_syphilis_uninfected_yesterday
i <- seq_along(daily_incidence)
chunks_incidence <- split(daily_incidence, ceiling(i/max))
yearly_sum_of_daily_incidences <- lapply(chunks_incidence, sum) #Note here that we don't have to divide by 365 ((x*365)/365)
yearly_avg_incidence_pct <- Map("*",yearly_sum_of_daily_incidences,c(100))
yaip_h <- unlist(yearly_avg_incidence_pct)
#
hiv_diagnosed_syphilis_infections <- counts_no_t$hiv_diagnosed_infected_with_syphilis
daily_infections<-hiv_diagnosed_syphilis_infections[2:(365*years)]
hiv_diagnosed_syphilis_uninfected <- counts_no_t$hiv_diagnosed_pop - counts_no_t$hiv_diagnosed_infected_with_syphilis
hiv_diagnosed_syphilis_uninfected_yesterday<-hiv_diagnosed_syphilis_uninfected[1:(365*years)-1]
hiv_syphilis_uninfected_yesterday[1]<-5000
daily_incidence<-daily_infections/hiv_diagnosed_syphilis_uninfected_yesterday
i <- seq_along(daily_incidence)
chunks_incidence <- split(daily_incidence, ceiling(i/max))
yearly_sum_of_daily_incidences <- lapply(chunks_incidence, sum) #Note here that we don't have to divide by 365 ((x*365)/365)
yearly_avg_incidence_pct <- Map("*",yearly_sum_of_daily_incidences,c(100))
yaip_no_t <- unlist(yearly_avg_incidence_pct)
#
hiv_diagnosed_syphilis_infections <- counts_t$hiv_diagnosed_infected_with_syphilis
daily_infections<-hiv_diagnosed_syphilis_infections[2:(365*years)]
hiv_diagnosed_syphilis_uninfected <- counts_t$hiv_diagnosed_pop - counts_t$hiv_diagnosed_infected_with_syphilis
hiv_diagnosed_syphilis_uninfected_yesterday<-hiv_diagnosed_syphilis_uninfected[1:(365*years)-1]
hiv_syphilis_uninfected_yesterday[1]<-5000
daily_incidence<-daily_infections/hiv_diagnosed_syphilis_uninfected_yesterday
i <- seq_along(daily_incidence)
chunks_incidence <- split(daily_incidence, ceiling(i/max))
yearly_sum_of_daily_incidences <- lapply(chunks_incidence, sum) #Note here that we don't have to divide by 365 ((x*365)/365)
yearly_avg_incidence_pct <- Map("*",yearly_sum_of_daily_incidences,c(100))
yaip_t <- unlist(yearly_avg_incidence_pct)
#
plot(x=1:length(yaip_h[-c(1, 2,3)]), y=yaip_h[-c(1, 2,3)], type="b", col='red', pch=15,cex=.8, lty=1,
ylab="Incidence (per 100 py)", xlab="Time (years)", main="Syphilis incidence among agents with HIV Diagnosis",
panel.first=grid(), ylim=c(0,25))
lines(1:length(yaip_t[-c(1, 2,3)]), yaip_t[-c(1, 2,3)], pch = 17,cex=.8, col = "blue", type = "b", lty = 2)
lines(1:length(yaip_no_t[-c(1, 2,3)]), yaip_no_t[-c(1, 2,3)], pch = 19,cex=.8, col = "black", type = "b", lty = 3)
#lines(1:length(yaip_no_t), rep(2,length(yaip_no_t)), pch = 19,cex=.5, col = "orange", type = "l", lty = 1)
legend("topright", legend=c("run 1", "run 2", "run 3"),
col=c("red", "blue", "black", "orange"), lty = c(1,2,3,1), cex=0.8)
# plot(x=1:length(yaip_h[-c(1, 2,3)]), y=yaip_h[-c(1, 2,3)], type="b", col='red', pch=15,cex=.8, lty=1,
#      ylab="Incidence (per 100 py)", xlab="Time (years)", main="Syphilis incidence among agents with HIV Diagnosis",
#      panel.first=grid(), ylim=c(0,10))
# lines(1:length(yaip_t[-c(1, 2,3)]), yaip_t[-c(1, 2,3)], pch = 17,cex=.8, col = "blue", type = "b", lty = 2)
# lines(1:length(yaip_no_t[-c(1, 2,3)]), yaip_no_t[-c(1, 2,3)], pch = 19,cex=.8, col = "black", type = "b", lty = 3)
# lines(1:length(yaip_no_t), rep(2,length(yaip_no_t)), pch = 19,cex=.5, col = "orange", type = "l", lty = 1)
# legend("topright", legend=c("Reduced Testing", "Std. 1-day Treatment", "No Treatment", "Target"),
#        col=c("red", "blue", "black", "orange"), lty = c(1,2,3,1), cex=0.8)
#
##Prevalence among agents with HIV
hiv_infected_with_syphilis <- counts_h$hiv_positives_who_currently_have_syphilis
hiv_infected <- counts_h$vertex_count - counts_h$uninfected - counts_h$hiv_positives_who_currently_have_syphilis
prev_h <- hiv_infected_with_syphilis/hiv_infected*100
hiv_infected_with_syphilis <- counts_no_t$hiv_positives_who_currently_have_syphilis
hiv_infected <- counts_no_t$vertex_count - counts_no_t$uninfected - counts_no_t$hiv_positives_who_currently_have_syphilis
prev_no_t <- hiv_infected_with_syphilis/hiv_infected*100
hiv_infected_with_syphilis <- counts_t$hiv_positives_who_currently_have_syphilis
hiv_infected <- counts_t$vertex_count - counts_t$uninfected - counts_t$hiv_positives_who_currently_have_syphilis
prev_t <- hiv_infected_with_syphilis/hiv_infected*100
plot(1:length(prev_no_t)/365, prev_no_t, type='l', col='black', pch=19,cex=0.8,lty=3,
xlab="Time (years)", ylab="Syphilis prevalence (%)", main="Syphilis prevalence among agents with HIV",
ylim=c(0,100))
lines(1:length(prev_t)/365, prev_t, pch = 17,cex=.8, col = "blue", type = "l", lty=2)
lines(1:length(prev_h)/365, prev_h, pch = 15,cex=.8, col = "red", type = "l", lty=1)
legend("topright", legend=c("run 1", "run 2", "run 3"),
col=c("red", "blue", "black"), lty = 1:3, cex=0.5)
##Prevalence among agents WITHOUT HIV
non_hiv_infected_with_syphilis <- counts_h$syphilis_infected - counts_h$hiv_positives_who_currently_have_syphilis
non_hiv_infected_without_syphilis <- counts_h$uninfected - non_hiv_infected_with_syphilis
prev_h <- non_hiv_infected_with_syphilis/non_hiv_infected_without_syphilis*100
non_hiv_infected_with_syphilis <- counts_no_t$syphilis_infected - counts_no_t$hiv_positives_who_currently_have_syphilis
non_hiv_infected_without_syphilis <- counts_no_t$uninfected - non_hiv_infected_with_syphilis
prev_no_t <- non_hiv_infected_with_syphilis/non_hiv_infected_without_syphilis*100
non_hiv_infected_with_syphilis <- counts_t$syphilis_infected - counts_t$hiv_positives_who_currently_have_syphilis
non_hiv_infected_without_syphilis <- counts_t$uninfected - non_hiv_infected_with_syphilis
prev_t <- non_hiv_infected_with_syphilis/non_hiv_infected_without_syphilis*100
plot(1:length(prev_no_t)/365, prev_no_t, type='l', col='black', pch=19,cex=0.8,lty=3,
xlab="Time (years)", ylab="Syphilis prevalence (%)", main="Syphilis prevalence among agents without HIV",
ylim=c(0,25))
lines(1:length(prev_t)/365, prev_t, pch = 17,cex=.8, col = "blue", type = "l", lty=2)
lines(1:length(prev_h)/365, prev_h, pch = 15,cex=.8, col = "red", type = "l", lty=1)
legend("topright", legend=c("run 1", "run 2", "run 3"),
col=c("red", "blue", "black"), lty = 1:3, cex=0.5)
#
# Oral sex measurements
# oral sex act count- steady AND casual. Only condomless
ggplot(data = counts_h)+
xlab("Time (years)")+theme_bw()+
ylab("Number of Sex Acts")+
geom_line(aes(x=tick/365, y=steady_sex_acts, color="Total Steady"))+
geom_line(aes(x=tick/365, y=casual_sex_acts, color="Total Casual"))+
geom_line(aes(x=tick/365, y=steady_sex_without_condom_oral, color="Steady Oral"))+
geom_line(aes(x=tick/365, y=casual_sex_without_condom_oral, color="Casual Oral"))+
scale_color_manual("",
limits = c("Total Casual","Casual Oral","Total Steady","Steady Oral"),
values = c('red','orange','blue', "green"))
ggplot(data = counts_h)+
xlab("Time (years)")+theme_bw()+
ylab("Overall Condom Use Rate (%)")+
geom_line(aes(x=tick/365, y=(sd_steady_sex_without_condom + sd_casual_sex_without_condom
+ sc_steady_sex_without_condom + sc_casual_sex_without_condom)
/ sex_acts * 100,
color="New Run"))+
ylab("Overall Condom Use Rate (%)")+
geom_line(data = counts_ho, aes(x=tick/365, y=(sd_steady_sex_without_condom + sd_casual_sex_without_condom
+ sc_steady_sex_without_condom + sc_casual_sex_without_condom)
/ sex_acts * 100,
color="Old Run"))+
# geom_line(aes(x=tick/365, y=casual_sex_acts, color="Total Casual"))+
# geom_line(aes(x=tick/365, y=steady_sex_without_condom_oral, color="Steady Oral"))+
# geom_line(aes(x=tick/365, y=casual_sex_without_condom_oral, color="Casual Oral"))+
scale_color_manual("",
limits = c("Old Run", "New Run"), #,"Casual Oral","Total Steady","Steady Oral"),
values = c('blue', 'orange'))+ #,'orange','blue', "green"))+
ylim(c(0,12))
source('/project2/ahotton/bryanb/bc-navigation/dec9_navlength/bc-navigation/data-analysis/BURNIN_calibration_plots_with_CI_oct-4-2021.R')
# Breast Cancer Prevalence (%)
ggplot()+
theme_bw()+
geom_line(data=control.df, alpha=0.1, aes(x=time/12, y=((number.of.positive.bc.agents/N)*100),color=con))+
geom_ribbon(data=control.df[1:360,], alpha=0.1, aes(x=time/12, y=((number.of.positive.bc.agents/N)*100),
ymin = time_lower(control.df, "number.of.positive.bc.agents")/N * 100,
ymax = time_upper(control.df, "number.of.positive.bc.agents")/N * 100,
color = con))+
geom_line(data=control.df_mean_at_time, aes(x=time/12, y=((m_number.of.positive.bc.agents/N)*100),color=con))+
labs(y="Breast Cancer Prevalence (%)")+
scale_color_manual("Scenario", values = c('black'),
limits= c("Burnin")
)+
xlab("Time (years)")#+
ggplot()+
theme_bw()+
geom_line(data=control.df, alpha=0.1, aes(x=time/12, y=number.of.diagnostic.referrals.at.t/number.of.screening.visits.at.t * 100, color = con))+
geom_ribbon(data=control.df[1:360,], alpha=0.1, aes(x=time/12,
ymin = ratio_lower(control.df) * 100,
ymax = ratio_upper(control.df) * 100,
color = con))+
geom_line(data=control.df_mean_at_time, aes(x=time/12, y=m_number.of.diagnostic.referrals.at.t/m_number.of.screening.visits.at.t* 100, color = con))+
scale_color_manual("Scenario", values = c('black'),
limits = c("Burnin")
)+
xlab("Time (years)")+
ylab("Screening Visit Recall Rate (%)")+
ylim(c(0,25))
# Hormone subtype breakdown (in terms of simple count of cases)
ggplot(control.df)+
geom_line(aes(x=time/12, y=number.of.hpos.agents), alpha=0.1)+
geom_line(aes(x=time/12, y=number.of.hneg.agents), alpha=0.1)+
geom_line(aes(x=time/12, y=number.of.positive.bc.agents), alpha=0.1)+
theme_bw()+
geom_line(data = control.df_mean_at_time,
aes(x=time/12, y=m_number.of.hpos.agents)
)+
geom_ribbon(data=control.df[1:360,], alpha=0.1, color = "black",
aes(x=time/12, y= number.of.hpos.agents,
ymin = time_lower(control.df, "number.of.hpos.agents"),
ymax = time_upper(control.df, "number.of.hpos.agents"),
color = "black")
)+
geom_line(data = control.df_mean_at_time,
aes(x=time/12, y=m_number.of.hneg.agents)
)+
geom_ribbon(data=control.df[1:360,], alpha=0.1, color = "black",
aes(x=time/12, y=number.of.hneg.agents,
ymin = time_lower(control.df, "number.of.hneg.agents"),
ymax = time_upper(control.df, "number.of.hneg.agents"),
color = "black")
)+
geom_line(data = control.df_mean_at_time,
aes(x=time/12, y=m_number.of.positive.bc.agents)
)+
geom_ribbon(data=control.df[1:360,], alpha=0.1, color = "black",
aes(x=time/12, y=number.of.positive.bc.agents,
ymin = time_lower(control.df, "number.of.positive.bc.agents"),
ymax = time_upper(control.df, "number.of.positive.bc.agents"))
)+
ylim(c(0, 150))+
annotate(geom="text", x=25, y=115, label="All cases", col="black")+
annotate(geom="text", x=25, y=90, label="Hormone-positive", col="black")+
annotate(geom="text", x=25, y=33, label="Hormone-negative", col="black")+
labs(x = "Time (years)", y = "Number of Cases")
