length(which(full_res$V112 == full_res$V112[1]))
length(which(full_res$V112 == full_res$V112[2]))
length(which(full_res$V112 == full_res$V112[3]))
length(which(full_res$V112 == full_res$V112[4]))
900/20
length(which(full_res$V112 == full_res$V112[110]))
length(which(full_res$V112 == full_res$V112[112]))
View(final_prep_base_mean)
final_prep_base_mean <- unlist(final_prep_base_mean)
View(final_prep_base_mean)
prep.cov.matrix <- matrix(ncol = 15, nrow = 6)
## Check PrEP usage at the end
final_prep_base <- lapply(1:15, function(y) lapply(base_instances[[y]], function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1)))
final_prep_base_mean <- lapply(1:15, function(x) mean(unlist(final_prep_base[[x]])))
final_prep_base_mean <- unlist(final_prep_base_mean)
prep.cov.matrix[1,] <- final_prep_base_mean
View(prep.cov.matrix)
final_prep_20 <- lapply(1:15, function(y) lapply(pct_20_instances[[y]], function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1)))
final_prep_20_mean <- lapply(1:15, function(x) mean(unlist(final_prep_base[[x]])))
final_prep_20_mean <-  unlist(final_prep_20_mean)
prep.cov.matrix[2,] <- final_prep_20_mean
View(prep.cov.matrix)
final_prep_20 <- lapply(1:15, function(y) lapply(pct_20_instances[[y]], function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1)))
final_prep_20_mean <- lapply(1:15, function(x) mean(unlist(final_prep_20[[x]])))
final_prep_20_mean <-  unlist(final_prep_20_mean)
prep.cov.matrix[2,] <- final_prep_20_mean
final_prep_base <- lapply(1:15, function(y) lapply(base_instances[[y]], function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1)))
final_prep_base_mean <- lapply(1:15, function(x) mean(unlist(final_prep_base[[x]])))
final_prep_base_mean <- unlist(final_prep_base_mean)
prep.cov.matrix[1,] <- final_prep_base_mean
final_prep_20 <- lapply(1:15, function(y) lapply(pct_20_instances[[y]], function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1)))
final_prep_20_mean <- lapply(1:15, function(x) mean(unlist(final_prep_20[[x]])))
final_prep_20_mean <-  unlist(final_prep_20_mean)
prep.cov.matrix[2,] <- final_prep_20_mean
final_prep_30 <- lapply(1:15, function(y) lapply(pct_30_instances[[y]], function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1)))
final_prep_30_mean <- lapply(1:15, function(x) mean(unlist(final_prep_30[[x]])))
final_prep_30_mean <-  unlist(final_prep_30_mean)
prep.cov.matrix[3,] <- final_prep_30_mean
final_prep_40 <- lapply(1:15, function(y) lapply(pct_40_instances[[y]], function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1)))
final_prep_40_mean <- lapply(1:15, function(x) mean(unlist(final_prep_40[[x]])))
final_prep_40_mean <-  unlist(final_prep_40_mean)
prep.cov.matrix[4,] <- final_prep_40_mean
final_prep_50 <- lapply(1:15, function(y) lapply(pct_50_instances[[y]], function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1)))
final_prep_50_mean <- lapply(1:15, function(x) mean(unlist(final_prep_50[[x]])))
final_prep_50_mean <-  unlist(final_prep_50_mean)
prep.cov.matrix[5,] <- final_prep_50_mean
final_prep_60 <- lapply(1:15, function(y) lapply(pct_60_instances[[y]], function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1)))
final_prep_60_mean <- lapply(1:15, function(x) mean(unlist(final_prep_60[[x]])))
final_prep_60_mean <-  unlist(final_prep_60_mean)
prep.cov.matrix[6,] <- final_prep_60_mean
base_instances
View(upf)
prep.cov.df <- as.data.frame(prep.cov.matrix)
prep.cov.df
View(prep.cov.df)
write.csv(prep.cov.df, "V51_eigen_prep_topn")
read.csv('V51_eigen_prep_topn.csv')
write.csv(prep.cov.df, "V51_eigen_prep_topn.csv")
read.csv('V51_eigen_prep_topn.csv')
asdf <- read.csv('V51_eigen_prep_topn.csv')
View(asdf)
pct_60_instances
source('/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r/v47_prep_eigen.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r/v47_prep_eigen.R', echo=TRUE)
View(final_prep_eigen)
source('/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r/v51_topn_prep_intersection.R', echo=TRUE)
setwd("/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r")
source('/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r/v51_topn_prep_intersection.R', echo=TRUE)
View(prep.cov.df)
source('/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r/prep-scaleup.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r/prep-scaleup.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r/prep-scaleup.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r/prep-scaleup.R', echo=TRUE)
#Summarize prevalence and incidence data in 10th year
prev.dt.finalyear <- prev.dt[ycat == 10]
avg.prev.finalyear <- prev.dt.finalyear[, .(avg = mean(mean)),
by=param_set]
inc.dt.finalyear <- inc.dt[ycat == 10]
avg.inc.finalyear <- inc.dt.finalyear[, .(avg = mean(full_inc_mean),
avg_1=mean(full_inc_mean_1),
avg_2=mean(full_inc_mean_2)),
by=param_set]
ggplot(avg.prev.finalyear,aes(x=param_set,y=avg,fill=c('13.7%','20%','30%','40%','50%','60%','70%','80%')))+geom_bar(stat='identity')+ggtitle('Prevalence in 10th year of intervention') +xlab('Parameter Set')+ labs(fill='Final PrEP Uptake')
ggplot(avg.inc.finalyear,aes(x=param_set,y=avg,fill=c('13.7%','20%','30%','40%','50%','60%','70%','80%')))+geom_bar(stat='identity')+ggtitle('Incidence in 10th year of intervention') + labs(fill='Final PrEP Uptake')
View(avg.inc.finalyear)
source('~/.active-rstudio-document', echo=TRUE)
View(prep.cov.matrix)
View(param_list_int)
View(param_list_inst[[1]])
param_list_inst <- lapply(instances, function(x) read.table(paste0(loc, "instance_",x,"/output/parameters.txt")))
#param_list <- lapply(instances, function(x) param_list_inst[[x]][c(116),3])  #param_list_inst index of prep increment
#param_list <- unlist(param_list)
#param_list_topn <- which(param_list == .1) #restrict to topn 10%
param_list_int <- lapply(instances, function(x) param_list_inst[[x]][c(98),3])  #param_list_inst index of prep increment
param_list_int <- unlist(param_list_int)
param_list_base_i <- which(param_list_int == 0)
param_list_20_i <- which(param_list_int == .0106)
param_list_30_i <- which(param_list_int == .0306)
param_list_40_i <- which(param_list_int == .0506)
param_list_50_i <- which(param_list_int == .0706)
param_list_60_i <- which(param_list_int == .0906)
base_instances <- lapply(1:15, function(x) intersect(param_list_base_i, eigen.intrv.prep.topn[,x]))
pct_20_instances <- lapply(1:15, function(x) intersect(param_list_20_i, eigen.intrv.prep.topn[,x]))
pct_30_instances <- lapply(1:15, function(x) intersect(param_list_30_i, eigen.intrv.prep.topn[,x]))
pct_40_instances <- lapply(1:15, function(x) intersect(param_list_40_i, eigen.intrv.prep.topn[,x]))
pct_50_instances <- lapply(1:15, function(x) intersect(param_list_50_i, eigen.intrv.prep.topn[,x]))
pct_60_instances <- lapply(1:15, function(x) intersect(param_list_60_i, eigen.intrv.prep.topn[,x]))
# Partition cases ---------------------------
n_ticks <- nrow(counts_data[[1]])
#for each instance want x-1 *nticks : x *nticks, lapply?
#base_rows <- lapply(base_instances, function(x) seq((x-1)*n_ticks, x*n_ticks))
#base_rows <-unlist(base_rows)
#pct_20_rows <- lapply(pct_20_instances, function(x) seq((x-1)*n_ticks, x*n_ticks))
#pct_20_rows <- unlist(pct_20_rows)
#pct_30_rows <- lapply(pct_30_instances, function(x) seq((x-1)*n_ticks, x*n_ticks))
#pct_30_rows <- unlist(pct_30_rows)
#pct_40_rows <- lapply(pct_40_instances, function(x) seq((x-1)*n_ticks, x*n_ticks))
#pct_40_rows <- unlist(pct_40_rows)
#pct_50_rows <- lapply(pct_50_instances, function(x) seq((x-1)*n_ticks, x*n_ticks))
#pct_50_rows <- unlist(pct_50_rows)
#pct_60_rows <- lapply(pct_60_instances, function(x) seq((x-1)*n_ticks, x*n_ticks))
#pct_60_rows <- unlist(pct_60_rows)
# Outcome 1 of interest: % of negatives on PrEP ---------------------------
#ggplot(counts_df[pct_30_rows,])+ #Change specific rows to be plotted here, based on defs above
#  geom_line(aes(x=tick/365, y=on_prep/uninfected, col=as.factor(instance)))+
#  xlab("time step")+ylab("mean degree")+
#  scale_y_continuous(limits=c(0, 1))+
#  ylab("% of negatives on PrEP (30% Scaleup)")+
#  xlab("Time (years)")
prep.cov.matrix <- matrix(ncol = 15, nrow = 6)
## Check PrEP usage at the end
final_prep_base <- lapply(1:15, function(y) lapply(base_instances[[y]], function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1)))
final_prep_base_mean <- lapply(1:15, function(x) mean(unlist(final_prep_base[[x]])))
final_prep_base_mean <- unlist(final_prep_base_mean)
prep.cov.matrix[1,] <- final_prep_base_mean
final_prep_20 <- lapply(1:15, function(y) lapply(pct_20_instances[[y]], function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1)))
final_prep_20_mean <- lapply(1:15, function(x) mean(unlist(final_prep_20[[x]])))
final_prep_20_mean <-  unlist(final_prep_20_mean)
prep.cov.matrix[2,] <- final_prep_20_mean
final_prep_30 <- lapply(1:15, function(y) lapply(pct_30_instances[[y]], function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1)))
final_prep_30_mean <- lapply(1:15, function(x) mean(unlist(final_prep_30[[x]])))
final_prep_30_mean <-  unlist(final_prep_30_mean)
prep.cov.matrix[3,] <- final_prep_30_mean
final_prep_40 <- lapply(1:15, function(y) lapply(pct_40_instances[[y]], function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1)))
final_prep_40_mean <- lapply(1:15, function(x) mean(unlist(final_prep_40[[x]])))
final_prep_40_mean <-  unlist(final_prep_40_mean)
prep.cov.matrix[4,] <- final_prep_40_mean
final_prep_50 <- lapply(1:15, function(y) lapply(pct_50_instances[[y]], function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1)))
final_prep_50_mean <- lapply(1:15, function(x) mean(unlist(final_prep_50[[x]])))
final_prep_50_mean <-  unlist(final_prep_50_mean)
prep.cov.matrix[5,] <- final_prep_50_mean
final_prep_60 <- lapply(1:15, function(y) lapply(pct_60_instances[[y]], function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1)))
final_prep_60_mean <- lapply(1:15, function(x) mean(unlist(final_prep_60[[x]])))
final_prep_60_mean <-  unlist(final_prep_60_mean)
prep.cov.matrix[6,] <- final_prep_60_mean
prep.cov.df <- as.data.frame(prep.cov.matrix)
write.csv(prep.cov.df, "V52_degree_prep_topn.csv")
View(prep.cov.dg)
View(prep.cov.df)
88*200
View(upf)
source('/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r/prep-scaleup.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r/prep-scaleup.R', echo=TRUE)
incidence.matrix <- matrix(ncol = 15, nrow = 6)
incdience.matrix <- avg.inc.finalyear[,1]
incidence.matrix <- matrix(ncol = 15, nrow = 6)
incidence.matrix <- avg.inc.finalyear[,1]
View(incidence.matrix)
avg.inc.finalyear
as.data.frame(avg.inc.finalyear)
as.data.frame(avg.inc.finalyear)
as.data.frame(avg.inc.finalyear[,2])
as.data.frame(avg.inc.finalyear[,2], ncol= 15)
as.data.frame(avg.inc.finalyear[,2], row.names= c(1,2,3,4,5,6))
for (i in 1:15){
incidence.matrix[,i] <- avg.inc.finalyear[,2][(i*6-5):(i*6)]
}
incidence.matrix <- matrix(ncol = 15, nrow = 6)
for (i in 1:15){
incidence.matrix[,i] <- avg.inc.finalyear[,2][(i*6-5):(i*6)]
}
(i*6-5):(i*6)
i
View(incidence.matrix)
incidence.matrix <- matrix(ncol = 15, nrow = 6)
View(incidence.matrix)
avg.inc.finalyear[,2][(1*6-5):(1*6)]
for (i in 1:15){
incidence.matrix[,i] <- unlist(avg.inc.finalyear[,2][(i*6-5):(i*6)])
}
View(incidence.matrix)
eigen.intrv.prep.topn[,1] <- which(upf$V6 == "eigen.intrv.prep.topn=0")
eigen.intrv.prep.topn[,2] <- which(upf$V6 == "eigen.intrv.prep.topn=0.01")
eigen.intrv.prep.topn[,3] <- which(upf$V6 == "eigen.intrv.prep.topn=0.02")
eigen.intrv.prep.topn[,4] <- which(upf$V6 == "eigen.intrv.prep.topn=0.03")
eigen.intrv.prep.topn[,5] <- which(upf$V6 == "eigen.intrv.prep.topn=0.04")
eigen.intrv.prep.topn[,6] <- which(upf$V6 == "eigen.intrv.prep.topn=0.05")
eigen.intrv.prep.topn[,7] <- which(upf$V6 == "eigen.intrv.prep.topn=0.1")
eigen.intrv.prep.topn[,8] <- which(upf$V6 == "eigen.intrv.prep.topn=0.15")
eigen.intrv.prep.topn[,9] <- which(upf$V6 == "eigen.intrv.prep.topn=0.2")
eigen.intrv.prep.topn[,10] <- which(upf$V6 == "eigen.intrv.prep.topn=0.25")
eigen.intrv.prep.topn[,11] <- which(upf$V6 == "eigen.intrv.prep.topn=0.3")
eigen.intrv.prep.topn[,12] <- which(upf$V6 == "eigen.intrv.prep.topn=0.35")
eigen.intrv.prep.topn[,13] <- which(upf$V6 == "eigen.intrv.prep.topn=0.4")
eigen.intrv.prep.topn[,14] <- which(upf$V6 == "eigen.intrv.prep.topn=0.45")
eigen.intrv.prep.topn[,15] <- which(upf$V6 == "eigen.intrv.prep.topn=0.5")
upf <- read.table(paste0(loc, "/eigen.txt"), sep=",")
eigen.intrv.prep.topn[,1] <- which(upf$V6 == "eigen.intrv.prep.topn=0")
eigen.intrv.prep.topn[,2] <- which(upf$V6 == "eigen.intrv.prep.topn=0.01")
eigen.intrv.prep.topn[,3] <- which(upf$V6 == "eigen.intrv.prep.topn=0.02")
eigen.intrv.prep.topn[,4] <- which(upf$V6 == "eigen.intrv.prep.topn=0.03")
eigen.intrv.prep.topn[,5] <- which(upf$V6 == "eigen.intrv.prep.topn=0.04")
eigen.intrv.prep.topn[,6] <- which(upf$V6 == "eigen.intrv.prep.topn=0.05")
eigen.intrv.prep.topn[,7] <- which(upf$V6 == "eigen.intrv.prep.topn=0.1")
eigen.intrv.prep.topn[,8] <- which(upf$V6 == "eigen.intrv.prep.topn=0.15")
eigen.intrv.prep.topn[,9] <- which(upf$V6 == "eigen.intrv.prep.topn=0.2")
eigen.intrv.prep.topn[,10] <- which(upf$V6 == "eigen.intrv.prep.topn=0.25")
eigen.intrv.prep.topn[,11] <- which(upf$V6 == "eigen.intrv.prep.topn=0.3")
eigen.intrv.prep.topn[,12] <- which(upf$V6 == "eigen.intrv.prep.topn=0.35")
eigen.intrv.prep.topn[,13] <- which(upf$V6 == "eigen.intrv.prep.topn=0.4")
eigen.intrv.prep.topn[,14] <- which(upf$V6 == "eigen.intrv.prep.topn=0.45")
eigen.intrv.prep.topn[,15] <- which(upf$V6 == "eigen.intrv.prep.topn=0.5")
View(upf)
eigen.intrv.prep.topn <- matrix(ncol=15, nrow = 60)
eigen.intrv.prep.topn[,1] <- which(upf$V6 == "eigen.intrv.prep.topn=0")
eigen.intrv.prep.topn[,2] <- which(upf$V6 == "eigen.intrv.prep.topn=0.01")
eigen.intrv.prep.topn[,3] <- which(upf$V6 == "eigen.intrv.prep.topn=0.02")
eigen.intrv.prep.topn[,4] <- which(upf$V6 == "eigen.intrv.prep.topn=0.03")
eigen.intrv.prep.topn[,5] <- which(upf$V6 == "eigen.intrv.prep.topn=0.04")
eigen.intrv.prep.topn[,6] <- which(upf$V6 == "eigen.intrv.prep.topn=0.05")
eigen.intrv.prep.topn[,7] <- which(upf$V6 == "eigen.intrv.prep.topn=0.1")
eigen.intrv.prep.topn[,8] <- which(upf$V6 == "eigen.intrv.prep.topn=0.15")
eigen.intrv.prep.topn[,9] <- which(upf$V6 == "eigen.intrv.prep.topn=0.2")
eigen.intrv.prep.topn[,10] <- which(upf$V6 == "eigen.intrv.prep.topn=0.25")
eigen.intrv.prep.topn[,11] <- which(upf$V6 == "eigen.intrv.prep.topn=0.3")
eigen.intrv.prep.topn[,12] <- which(upf$V6 == "eigen.intrv.prep.topn=0.35")
eigen.intrv.prep.topn[,13] <- which(upf$V6 == "eigen.intrv.prep.topn=0.4")
eigen.intrv.prep.topn[,14] <- which(upf$V6 == "eigen.intrv.prep.topn=0.45")
eigen.intrv.prep.topn[,15] <- which(upf$V6 == "eigen.intrv.prep.topn=0.5")
View(eigen.intrv.prep.topn)
View(avg.inc.finalyear)
View(upf)
View(inc.dt)
inc.dt[, param_set := rep(1:90, each=10)]
inc.dt[, seed := rep(rep(1:10, each=1), 90)]
#Summarize prevalence data over time
prev_year <- prev.dt %>% group_by(ycat,param_set) %>% summarise(avg=mean(mean))
ggplot(prev_year, aes(x=ycat,y=avg, group=param_set, color=param_set))+geom_line() + ggtitle('Prevalence over 20 Years') + xlab('Year') + ylab('Prevalence')
#Summarize Incidence data over time
inc_year <- inc.dt %>% group_by(ycat,param_set) %>% summarise(avg=mean(full_inc_mean))
ggplot(inc_year, aes(x=ycat,y=avg, group=param_set, color=param_set))+geom_line() + xlab('Year of Intervention') + ylab('Incidence') + ggtitle('Incidence over 20 Years')
#Summarize prevalence and incidence data in 10th year
prev.dt.finalyear <- prev.dt[ycat == 10]
avg.prev.finalyear <- prev.dt.finalyear[, .(avg = mean(mean)),
by=param_set]
inc.dt.finalyear <- inc.dt[ycat == 10]
avg.inc.finalyear <- inc.dt.finalyear[, .(avg = mean(full_inc_mean),
avg_1=mean(full_inc_mean_1),
avg_2=mean(full_inc_mean_2)),
by=param_set]
#ggplot(avg.prev.finalyear,aes(x=param_set,y=avg,fill=c('13.7%','20%','30%','40%','50%','60%','70%','80%')))+geom_bar(stat='identity')+ggtitle('Prevalence in 10th year of intervention') +xlab('Parameter Set')+ labs(fill='Final PrEP Uptake')
#ggplot(avg.inc.finalyear,aes(x=param_set,y=avg,fill=c('13.7%','20%','30%','40%','50%','60%','70%','80%')))+geom_bar(stat='identity')+ggtitle('Incidence in 10th year of intervention') + labs(fill='Final PrEP Uptake')
eigen.intrv.prep.topn <- matrix(ncol=15, nrow = 60)
eigen.intrv.prep.topn[,1] <- which(upf$V6 == "eigen.intrv.prep.topn=0")
eigen.intrv.prep.topn[,2] <- which(upf$V6 == "eigen.intrv.prep.topn=0.01")
eigen.intrv.prep.topn[,3] <- which(upf$V6 == "eigen.intrv.prep.topn=0.02")
eigen.intrv.prep.topn[,4] <- which(upf$V6 == "eigen.intrv.prep.topn=0.03")
eigen.intrv.prep.topn[,5] <- which(upf$V6 == "eigen.intrv.prep.topn=0.04")
eigen.intrv.prep.topn[,6] <- which(upf$V6 == "eigen.intrv.prep.topn=0.05")
eigen.intrv.prep.topn[,7] <- which(upf$V6 == "eigen.intrv.prep.topn=0.1")
eigen.intrv.prep.topn[,8] <- which(upf$V6 == "eigen.intrv.prep.topn=0.15")
eigen.intrv.prep.topn[,9] <- which(upf$V6 == "eigen.intrv.prep.topn=0.2")
eigen.intrv.prep.topn[,10] <- which(upf$V6 == "eigen.intrv.prep.topn=0.25")
eigen.intrv.prep.topn[,11] <- which(upf$V6 == "eigen.intrv.prep.topn=0.3")
eigen.intrv.prep.topn[,12] <- which(upf$V6 == "eigen.intrv.prep.topn=0.35")
eigen.intrv.prep.topn[,13] <- which(upf$V6 == "eigen.intrv.prep.topn=0.4")
eigen.intrv.prep.topn[,14] <- which(upf$V6 == "eigen.intrv.prep.topn=0.45")
eigen.intrv.prep.topn[,15] <- which(upf$V6 == "eigen.intrv.prep.topn=0.5")
for (i in 1:15){
incidence.matrix[,i] <- unlist(avg.inc.finalyear[,2][(i*6-5):(i*6)])
}
incidence.matrix <- matrix(ncol = 15, nrow = 6)
incidence.matrix <- avg.inc.finalyear[,2]
View(incidence.matrix)
incidence.matrix <- matrix(ncol = 15, nrow = 6)
for (i in 1:15){
incidence.matrix[,i] <- unlist(avg.inc.finalyear[,2][(i*6-5):(i*6)])
}
rep(1:90, each=10)
source('/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r/prep-scaleup.R', echo=TRUE)
inc.dt[, seed := rep(rep(1:10, each=10), 90)]
#Summarize prevalence data over time
prev_year <- prev.dt %>% group_by(ycat,param_set) %>% summarise(avg=mean(mean))
ggplot(prev_year, aes(x=ycat,y=avg, group=param_set, color=param_set))+geom_line() + ggtitle('Prevalence over 20 Years') + xlab('Year') + ylab('Prevalence')
#Summarize Incidence data over time
inc_year <- inc.dt %>% group_by(ycat,param_set) %>% summarise(avg=mean(full_inc_mean))
ggplot(inc_year, aes(x=ycat,y=avg, group=param_set, color=param_set))+geom_line() + xlab('Year of Intervention') + ylab('Incidence') + ggtitle('Incidence over 20 Years')
#Summarize prevalence and incidence data in 10th year
prev.dt.finalyear <- prev.dt[ycat == 10]
avg.prev.finalyear <- prev.dt.finalyear[, .(avg = mean(mean)),
by=param_set]
inc.dt.finalyear <- inc.dt[ycat == 10]
avg.inc.finalyear <- inc.dt.finalyear[, .(avg = mean(full_inc_mean),
avg_1=mean(full_inc_mean_1),
avg_2=mean(full_inc_mean_2)),
by=param_set]
#ggplot(avg.prev.finalyear,aes(x=param_set,y=avg,fill=c('13.7%','20%','30%','40%','50%','60%','70%','80%')))+geom_bar(stat='identity')+ggtitle('Prevalence in 10th year of intervention') +xlab('Parameter Set')+ labs(fill='Final PrEP Uptake')
#ggplot(avg.inc.finalyear,aes(x=param_set,y=avg,fill=c('13.7%','20%','30%','40%','50%','60%','70%','80%')))+geom_bar(stat='identity')+ggtitle('Incidence in 10th year of intervention') + labs(fill='Final PrEP Uptake')
eigen.intrv.prep.topn <- matrix(ncol=15, nrow = 60)
eigen.intrv.prep.topn[,1] <- which(upf$V6 == "eigen.intrv.prep.topn=0")
eigen.intrv.prep.topn[,2] <- which(upf$V6 == "eigen.intrv.prep.topn=0.01")
eigen.intrv.prep.topn[,3] <- which(upf$V6 == "eigen.intrv.prep.topn=0.02")
eigen.intrv.prep.topn[,4] <- which(upf$V6 == "eigen.intrv.prep.topn=0.03")
eigen.intrv.prep.topn[,5] <- which(upf$V6 == "eigen.intrv.prep.topn=0.04")
eigen.intrv.prep.topn[,6] <- which(upf$V6 == "eigen.intrv.prep.topn=0.05")
eigen.intrv.prep.topn[,7] <- which(upf$V6 == "eigen.intrv.prep.topn=0.1")
eigen.intrv.prep.topn[,8] <- which(upf$V6 == "eigen.intrv.prep.topn=0.15")
eigen.intrv.prep.topn[,9] <- which(upf$V6 == "eigen.intrv.prep.topn=0.2")
eigen.intrv.prep.topn[,10] <- which(upf$V6 == "eigen.intrv.prep.topn=0.25")
eigen.intrv.prep.topn[,11] <- which(upf$V6 == "eigen.intrv.prep.topn=0.3")
eigen.intrv.prep.topn[,12] <- which(upf$V6 == "eigen.intrv.prep.topn=0.35")
eigen.intrv.prep.topn[,13] <- which(upf$V6 == "eigen.intrv.prep.topn=0.4")
eigen.intrv.prep.topn[,14] <- which(upf$V6 == "eigen.intrv.prep.topn=0.45")
eigen.intrv.prep.topn[,15] <- which(upf$V6 == "eigen.intrv.prep.topn=0.5")
incidence.matrix <- matrix(ncol = 15, nrow = 6)
for (i in 1:15){
incidence.matrix[,i] <- unlist(avg.inc.finalyear[,2][(i*6-5):(i*6)])
}
View(incidence.matrix)
)
all_responses$param_set <- rep(1:90, each=10)
all_responses$seed <- rep(1:10, 90)
all_responses$param_set <- rep(1:90, each=10)
all_responses$seed <- rep(1:10, 90)
mean(all_responses$inc_transm_full[37:42])
incidence.matrix <- matrix(ncol = 15, nrow = 6)
for (i in 1:15){
incidence.matrix[,i] <- unlist(avg.inc.finalyear[,3][(i*6-5):(i*6)])
}
incidence.matrix <- matrix(ncol = 15, nrow = 6)
for (i in 1:15){
incidence.matrix[,i] <- unlist(avg.inc.finalyear[,2][(i*6-5):(i*6)])
}
source('/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r/prep-scaleup.R', echo=TRUE)
View(incidence.matrix)
View(avg.inc.finalyear)
write.csv(incidence.matrix, "V52_degree_inc.csv")
incidence.matrix <- matrix(ncol = 15, nrow = 6)
for (i in 1:15){
incidence.matrix[,i] <- unlist(round(avg.inc.finalyear[,2][(i*6-5):(i*6)], 2)
}
incidence.matrix <- matrix(ncol = 15, nrow = 6)
for (i in 1:15){
incidence.matrix[,i] <- unlist(round(avg.inc.finalyear[,2][(i*6-5):(i*6)], 2))
}
View(incidence.matrix)
write.csv(incidence.matrix, "V52_degree_inc.csv")
n.scen <- 6
n.seed <- 10
all_responses$param_set <- rep(1:n.scen, each=n.seed)
all_responses$seed <- rep(1:n.seed, 1)
rep(1:n.scen, each=n.seed*n.years)
n.years <- 10
rep(1:n.scen, each=n.seed*n.years)
9000/600
View(inc.dt.10)
source('/project/khanna7/Projects/midway2/BARS/transmission_model/swift_proj/experiments/data-analysis/r/v52-eigen.R', echo=TRUE)
rep(1:n.scen, each=n.seed*n.years)
n.scen <- 6
n.seed <- 10
rep(1:n.scen, each=n.seed*n.years)
n.years <- 10
rep(1:n.scen, each=n.seed*n.years)
mean(incidence.matrix[6,])
source('/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r/prep-scaleup.R', echo=TRUE)
library(readr)
dataset <- read_csv(NULL)
View(dataset)
mean(incidence.matrix[6,])
mean(incidence.matrix[5,])
mean(incidence.matrix[4,])
mean(incidence.matrix[3,])
mean(incidence.matrix[2,])
source('/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r/prep-scaleup.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bc-navigation/simulate-disease-progression.R', echo=TRUE)
setwd("/project/khanna7/abbyskwara/repos/bc-navigation")
source('/project/khanna7/abbyskwara/repos/bc-navigation/simulate-disease-progression.R', echo=TRUE)
net0_bip %v% "bc_risk"
net0_bip[1] %v% age
net0_bip[1,1] %v% age
net0_bip %v% age
net0_bip %v% age [1]
setwd("/project/khanna7/Projects/midway2/BARS/transmission_model/swift_proj/experiments/data-analysis/r")
?std
?sd
sd(final_prep_70)/length(final_prep_70)
source('/project/khanna7/abbyskwara/repos/bars_test/transmission_model/swift_proj/experiments/data-analysis/r/v46_prep_retention.R', echo=TRUE)
> sd(final_prep_70)/length(final_prep_70)
sd(final_prep_70)/length(final_prep_70)
sd(final_prep_70)
final_prep_base <- lapply(param_list_base_i, function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1))
final_prep_base <- unlist(final_prep_base)
mean_base <- mean(final_prep_base)
sd_base <- (sd(final_prep_base)/length(final_prep_base))
final_prep_20 <- lapply(param_list_20_i, function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1))
final_prep_20 <- unlist(final_prep_20)
mean_20 <- mean(final_prep_20)
sd_20 <- (sd(final_prep_20)/length(final_prep_20))
final_prep_30 <- lapply(param_list_30_i, function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1))
final_prep_30 <- unlist(final_prep_30)
mean_30 <- mean(final_prep_30)
sd_30 <- (sd(final_prep_30)/length(final_prep_30))
final_prep_40 <- lapply(param_list_40_i, function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1))
final_prep_40 <- unlist(final_prep_40)
mean_40 <- mean(final_prep_40)
sd_40 <- (sd(final_prep_40)/length(final_prep_40))
final_prep_50 <- lapply(param_list_50_i, function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1))
final_prep_50 <- unlist(final_prep_50)
mean_50 <- mean(final_prep_50)
sd_50 <- (sd(final_prep_50)/length(final_prep_50))
final_prep_60 <- lapply(param_list_60_i, function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1))
final_prep_60 <- unlist(final_prep_60)
mean_60 <- mean(final_prep_60)
sd_60 <- (sd(final_prep_60)/length(final_prep_60))
final_prep_70 <- lapply(param_list_70_i, function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1))
final_prep_70 <- unlist(final_prep_70)
mean_70 <- mean(final_prep_70)
sd_70 <- (sd(final_prep_70)/length(final_prep_70))
final_prep_retention <- c(mean_base, mean_20, mean_30, mean_40, mean_50, mean_60, mean_70)
prep_std_error <- c(sd_base, sd_20, sd_30, sd_40, sd_50, sd_60, sd_70)
View(prep_std_error)
length(final_prep_70)
View(final_prep_20)
sd(final_prep_20)
mean(final_prep_20
)
mean(final_prep_20)/sd(final_prep_20)
sqrt(10)
final_prep_base <- lapply(param_list_base_i, function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1))
final_prep_base <- unlist(final_prep_base)
mean_base <- mean(final_prep_base)
sd_base <- (sd(final_prep_base)/sqrt(length(final_prep_base)))
final_prep_20 <- lapply(param_list_20_i, function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1))
final_prep_20 <- unlist(final_prep_20)
mean_20 <- mean(final_prep_20)
sd_20 <- (sd(final_prep_20)/sqrt(length(final_prep_20)))
final_prep_30 <- lapply(param_list_30_i, function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1))
final_prep_30 <- unlist(final_prep_30)
mean_30 <- mean(final_prep_30)
sd_30 <- (sd(final_prep_30)/sqrt(length(final_prep_30)))
final_prep_40 <- lapply(param_list_40_i, function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1))
final_prep_40 <- unlist(final_prep_40)
mean_40 <- mean(final_prep_40)
sd_40 <- (sd(final_prep_40)/sqrt(length(final_prep_40)))
final_prep_50 <- lapply(param_list_50_i, function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1))
final_prep_50 <- unlist(final_prep_50)
mean_50 <- mean(final_prep_50)
sd_50 <- (sd(final_prep_50)/sqrt(length(final_prep_50)))
final_prep_60 <- lapply(param_list_60_i, function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1))
final_prep_60 <- unlist(final_prep_60)
mean_60 <- mean(final_prep_60)
sd_60 <- (sd(final_prep_60)/sqrt(length(final_prep_60)))
final_prep_70 <- lapply(param_list_70_i, function(x) tail(counts_data[[x]]$on_prep/counts_data[[x]]$uninfected,1))
final_prep_70 <- unlist(final_prep_70)
mean_70 <- mean(final_prep_70)
sd_70 <- (sd(final_prep_70)/sqrt(length(final_prep_70)))
final_prep_retention <- c(mean_base, mean_20, mean_30, mean_40, mean_50, mean_60, mean_70)
prep_std_error <- c(sd_base, sd_20, sd_30, sd_40, sd_50, sd_60, sd_70)
View(prep_std_error)
setwd("/project/khanna7/abbyskwara/repos/bc-navigation")
source('/project/khanna7/abbyskwara/repos/bc-navigation/simulate-disease-progression.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bc-navigation/simulate-disease-progression.R', echo=TRUE)
net0_bip[1]
net0_bip[1] %v% age
source('/project/khanna7/abbyskwara/repos/bc-navigation/simulate-disease-progression.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bc-navigation/clinical-engagement.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bc-navigation/clinical-engagement.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bc-navigation/Time_simulation.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bc-navigation/estimation.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bc-navigation/Time_simulation.R', echo=TRUE)
estimation_net <- load("estimation_net.RData")
main(disease_progression(estimation_net))
main_disease_progression(estimation_net))
main_disease_progression(estimation_net)
source('/project/khanna7/abbyskwara/repos/bc-navigation/estimation.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bc-navigation/Time_simulation.R', echo=TRUE)
main_estimation(parameters.R)
main_estimation("parameters.R")
source('/project/khanna7/abbyskwara/repos/bc-navigation/Time_simulation.R', echo=TRUE)
estimation_net <- load("estimation_net.RData")
i
main_disease_progression(estimation_net)
estimation_net
net0_bip
load("/project/khanna7/abbyskwara/repos/bc-navigation/estimation_net.RData")
source('/project/khanna7/abbyskwara/repos/bc-navigation/estimation.R', echo=TRUE)
main_estimation("parameters.R")
source('/project/khanna7/abbyskwara/repos/bc-navigation/Time_simulation.R', echo=TRUE)
load("/project/khanna7/abbyskwara/repos/bc-navigation/estimation_net.RData")
source('/project/khanna7/abbyskwara/repos/bc-navigation/Time_simulation.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bc-navigation/Time_simulation.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bc-navigation/estimation.R', echo=TRUE)
main_estimation("parameters.R")
source('/project/khanna7/abbyskwara/repos/bc-navigation/Time_simulation.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bc-navigation/clinical-engagement.R', echo=TRUE)
source('/project/khanna7/abbyskwara/repos/bc-navigation/Time_simulation.R', echo=TRUE)
fd.rel.risk
bc.risk.70to75
bc.risk.50to60
hpos_risk
hneg_ris
hneg_risk
